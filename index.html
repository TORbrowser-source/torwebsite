const sendMessage = async () => {
  const userText = userInput.value.trim();
  if (!userText) return;

  appendMessage('User', userText);
  userInput.value = '';
  appendMessage('TOR', 'Thinking...');

  try {
    const response = await fetch('https://torbackend-rol0l6b1l-aleksis-projects-dcac9c15.vercel.app/api/ask', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ query: userText }),
    });

    const data = await response.json();
    if (data.answer) {
      messages.lastChild.textContent = `TOR: ${data.answer}`;
    } else {
      messages.lastChild.textContent = 'TOR: Failed to get a response.';
    }
  } catch (error) {
    messages.lastChild.textContent = 'TOR: Error connecting to the server.';
    console.error('Fetch error:', error);
  }
};
